# Архитектура проекта AI EVOLVE (Рефакторинг)

## Обзор

Проект AI EVOLVE представляет собой игру с развивающимся ИИ, построенную на принципах модульной архитектуры с четким разделением ответственности.

## Структура проекта

```
AI EVOLVE/
├── config/                     # Конфигурационные файлы
│   ├── game_settings.json     # Основные настройки игры
│   ├── entities_config.json   # Настройки игровых сущностей
│   ├── items_config.json      # Настройки предметов
│   ├── ai_config.json         # Настройки AI системы
│   ├── ui_config.json         # Настройки пользовательского интерфейса
│   ├── config_manager.py      # Менеджер конфигурации
│   ├── game_constants.py      # Константы игры
│   └── __init__.py
├── core/                       # Основные системы игры
│   ├── database_manager.py    # Управление базой данных
│   ├── data_manager.py        # Управление данными
│   ├── game_state_manager.py  # Управление состоянием игры
│   ├── game_logic_manager.py  # Игровая логика
│   ├── resource_manager.py    # Управление ресурсами
│   ├── skill_system.py        # Система навыков
│   ├── leveling_system.py     # Система развития
│   ├── transform.py           # Трансформации
│   ├── component.py           # Система компонентов
│   ├── inventory.py           # Система инвентаря
│   ├── attributes.py          # Система атрибутов
│   ├── combat_stats.py        # Боевая статистика
│   ├── entity_attribute_manager.py # Управление атрибутами сущностей
│   ├── interfaces.py          # Интерфейсы
│   └── ai_update_scheduler.py # Планировщик обновлений AI
├── entities/                   # Игровые сущности
│   ├── base_entity.py         # Базовая сущность
│   ├── player.py              # Игрок
│   ├── enemy.py               # Враг
│   ├── entity_factory.py      # Фабрика сущностей
│   ├── effect.py              # Эффекты
│   └── __init__.py
├── ai/                        # Система искусственного интеллекта
│   ├── ai_core.py             # Основное ядро AI
│   ├── ai_manager.py          # Менеджер AI
│   ├── memory.py              # Система памяти
│   ├── learning.py            # Система обучения
│   ├── pattern_recognizer.py  # Распознавание паттернов
│   ├── decision_maker.py      # Принятие решений
│   └── __init__.py
├── combat/                    # Боевая система
│   ├── damage_system.py       # Система урона
│   └── elemental_combat.py    # Элементальный бой
├── items/                     # Система предметов
│   ├── item_manager.py        # Менеджер предметов
│   └── __init__.py
├── ui/                        # Пользовательский интерфейс
│   ├── main_window.py         # Главное окно
│   ├── render_manager.py      # Менеджер рендеринга
│   ├── game_menu.py           # Игровое меню
│   ├── buttons.py             # Кнопки интерфейса
│   ├── camera.py              # Камера
│   └── __init__.py
├── utils/                     # Утилиты
│   ├── logger_config.py       # Конфигурация логирования
│   ├── game_utils.py          # Игровые утилиты
│   ├── entity_id_generator.py # Генератор ID сущностей
│   └── __init__.py
├── data/                      # Данные игры
│   ├── game_data.db           # База данных
│   ├── items.json             # Предметы
│   ├── entities.json          # Сущности
│   └── conversion_log.json    # Лог конвертации
├── logs/                      # Логи игры
├── saves/                     # Сохранения
├── map/                       # Карты
├── backup/                    # Резервные копии
├── main.py                    # Главный файл игры
├── run_game_ui.py             # Запуск UI версии
├── requirements.txt            # Зависимости
├── README.md                  # Документация
└── ARCHITECTURE_REFACTORED.md # Этот файл
```

## Принципы архитектуры

### 1. Разделение ответственности
- **config/** - все настройки и конфигурация
- **core/** - основные системы игры
- **entities/** - игровые сущности
- **ai/** - система искусственного интеллекта
- **ui/** - пользовательский интерфейс
- **utils/** - вспомогательные функции

### 2. Конфигурация
- Все настройки хранятся в JSON файлах
- Настройки игровых сущностей хранятся в базе данных
- Централизованное управление через ConfigManager

### 3. Модульность
- Каждый модуль имеет четко определенную ответственность
- Минимальные зависимости между модулями
- Использование интерфейсов для слабой связанности

### 4. Расширяемость
- Система компонентов для сущностей
- Плагинная архитектура для AI
- Конфигурируемые системы

## Основные системы

### ConfigManager
Централизованный менеджер конфигурации, который:
- Загружает настройки из JSON файлов
- Предоставляет единый интерфейс для доступа к настройкам
- Поддерживает горячую перезагрузку конфигурации
- Обеспечивает потокобезопасность

### DatabaseManager
Управляет базой данных SQLite для:
- Хранения данных игровых сущностей
- Управления атрибутами и эффектами
- Резервного копирования и восстановления

### GameStateManager
Управляет состоянием игры:
- Текущее состояние игрока
- Список врагов и NPC
- Игровые события и триггеры

### EntityFactory
Создает игровые сущности:
- Игроки
- Враги
- NPC
- Боссы

### AICore
Основное ядро искусственного интеллекта:
- Принятие решений
- Обучение и адаптация
- Распознавание паттернов
- Эмоциональная система

## Конфигурационные файлы

### game_settings.json
Основные настройки игры:
- Параметры отображения
- Аудио настройки
- Игровой процесс
- Боевая система
- Физика и рендеринг

### entities_config.json
Настройки игровых сущностей:
- Базовые характеристики
- Системы развития
- Поведение AI
- Системы лута

### items_config.json
Настройки предметов:
- Оружие и броня
- Расходники
- Материалы
- Требования и характеристики

### ai_config.json
Настройки AI системы:
- Параметры обучения
- Поведенческие настройки
- Эмоциональная система
- Система памяти

### ui_config.json
Настройки интерфейса:
- Темы и цвета
- Расположение элементов
- Управление
- Доступность

## Логирование и мониторинг

### Система логирования
- Логирование в файлы и консоль
- Различные уровни логирования
- Ротация логов
- Структурированные сообщения

### Мониторинг системы
- Отслеживание производительности
- Мониторинг памяти
- Логирование ошибок
- Метрики игры

## Безопасность

### Валидация данных
- Проверка входных данных
- Валидация конфигурации
- Защита от инъекций SQL
- Проверка целостности файлов

### Резервное копирование
- Автоматическое резервное копирование БД
- Версионирование конфигурации
- Восстановление из резервных копий

## Производительность

### Оптимизация
- Ленивая загрузка ресурсов
- Кэширование данных
- Асинхронные операции
- Оптимизация рендеринга

### Масштабируемость
- Модульная архитектура
- Конфигурируемые системы
- Плагинная система
- Горизонтальное масштабирование

## Разработка и тестирование

### Структура кода
- Следование PEP 8
- Типизация с помощью type hints
- Документирование кода
- Обработка ошибок

### Тестирование
- Модульные тесты
- Интеграционные тесты
- Тесты производительности
- Автоматизированное тестирование

## Развертывание

### Требования
- Python 3.8+
- SQLite 3
- Зависимости из requirements.txt

### Установка
1. Клонирование репозитория
2. Установка зависимостей
3. Настройка конфигурации
4. Запуск игры

### Конфигурация
- Настройка путей к файлам
- Конфигурация базы данных
- Настройка логирования
- Параметры производительности

## Заключение

Рефакторинг проекта AI EVOLVE привел к созданию чистой, модульной архитектуры с четким разделением ответственности. Все настройки теперь хранятся в структурированных JSON файлах, а игровые сущности - в базе данных. Это обеспечивает гибкость, расширяемость и легкость поддержки кода.
